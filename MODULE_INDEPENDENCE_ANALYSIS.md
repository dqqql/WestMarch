# WestMarch 项目模块独立性评估报告

**评估日期**: 2026-02-25  
**项目版本**: WestMarch v1.0  
**评估范围**: 所有核心模块、API 路由、Context 层、页面组件、库模块

---

## 目录

1. [评估标准](#1-评估标准)
2. [核心基础设施模块](#2-核心基础设施模块)
3. [上下文模块 (Contexts)](#3-上下文模块-contexts)
4. [库模块 (Lib)](#4-库模块-lib)
5. [UI 组件模块](#5-ui-组件模块)
6. [API 路由模块](#6-api-路由模块)
7. [页面模块 (Pages)](#7-页面模块-pages)
8. [模块独立性总结](#8-模块独立性总结)
9. [满足独立修改/删除条件的模块](#9-满足独立修改删除条件的模块)

---

## 1. 评估标准

### 1.1 评分体系

| 维度 | 评分标准 | 满分 |
|------|---------|------|
| 接口清晰度 | 接口是否清晰定义、类型完整、文档充足 | 10 分 |
| 依赖管理 | 是否通过接口依赖，是否存在直接依赖 | 10 分 |
| 单一职责 | 是否只负责一个明确的功能领域 | 10 分 |
| 配置分离 | 配置与业务逻辑是否分离 | 10 分 |
| 可独立修改 | 修改该模块是否不影响其他模块 | 10 分 |
| 可独立删除 | 删除该模块是否不破坏系统其他部分 | 10 分 |
| **总分** | **各项评分之和** | **60 分** |

### 1.2 评级定义

| 总分范围 | 评级 | 说明 |
|---------|------|------|
| 50-60 分 | 🟢 **优秀** | 模块独立性极高，完全满足独立修改/删除条件 |
| 40-49 分 | 🟡 **良好** | 模块独立性较好，基本满足独立修改/删除条件 |
| 30-39 分 | 🟠 **中等** | 模块独立性一般，部分满足独立修改/删除条件 |
| 20-29 分 | 🔴 **较差** | 模块独立性较差，不满足独立修改/删除条件 |
| 0-19 分 | ⚫ **很差** | 模块与系统深度耦合，完全无法独立修改/删除 |

---

## 2. 核心基础设施模块

### 2.1 prisma/schema.prisma - 数据库模型定义

| 评估维度 | 评分 | 说明 |
|---------|------|------|
| 接口清晰度 | 8 分 | 使用 Prisma Schema 语言，类型定义清晰完整 |
| 依赖管理 | 10 分 | 作为数据模型定义层，无外部依赖 |
| 单一职责 | 9 分 | 仅负责定义数据库模型和关系，职责单一 |
| 配置分离 | 7 分 | 数据库连接配置通过环境变量，但枚举类型硬编码 |
| 可独立修改 | 5 分 | 修改会影响所有使用 Prisma Client 的模块 |
| 可独立删除 | 0 分 | 删除会导致整个数据层崩溃 |
| **总分** | **39 分** | 🟠 **中等** |

**详细分析**:
- ✅ **优点**: 使用类型安全的 Schema 定义，关系清晰
- ⚠️ **问题**: 所有 API 路由和 Prisma Client 都直接依赖此文件
- ❌ **独立性评估**: **不满足独立修改/删除条件**

---

### 2.2 src/app/layout.tsx - 根布局

| 评估维度 | 评分 | 说明 |
|---------|------|------|
| 接口清晰度 | 9 分 | Next.js 标准布局，职责清晰 |
| 依赖管理 | 7 分 | 依赖多个 Context Provider，但通过标准方式组合 |
| 单一职责 | 8 分 | 负责全局 Provider 组合和 HTML 结构 |
| 配置分离 | 8 分 | 元数据配置分离，但主题配置硬编码 |
| 可独立修改 | 5 分 | 修改 Provider 顺序会影响整个应用 |
| 可独立删除 | 0 分 | 根布局是 Next.js 必需文件 |
| **总分** | **37 分** | 🟠 **中等** |

**详细分析**:
- ✅ **优点**: 正确组合了 ThemeProvider、AuthProvider、AppProvider
- ⚠️ **问题**: 作为应用入口，所有页面都依赖它
- ❌ **独立性评估**: **不满足独立修改/删除条件**

---

## 3. 上下文模块 (Contexts)

### 3.1 src/contexts/AuthContext.tsx - 认证上下文

| 评估维度 | 评分 | 说明 |
|---------|------|------|
| 接口清晰度 | 8 分 | 提供 `useAuth()` hook，接口设计合理 |
| 依赖管理 | 5 分 | 直接依赖 `/api/auth/login` API 和 localStorage |
| 单一职责 | 7 分 | 主要负责认证，但混合了 localStorage 存储逻辑 |
| 配置分离 | 4 分 | localStorage key 硬编码，无配置文件 |
| 可独立修改 | 3 分 | 修改会影响所有使用 `useAuth()` 的模块 |
| 可独立删除 | 0 分 | 删除会导致认证功能完全失效 |
| **总分** | **27 分** | 🔴 **较差** |

**详细分析**:
- ✅ **优点**: 提供清晰的 `login()`/`logout()` 接口
- ⚠️ **问题**: 
  - 直接使用 localStorage，存储逻辑与认证逻辑耦合
  - 硬编码 `westmarch_user` key
  - 所有需要认证的页面都依赖此 Context
- ❌ **独立性评估**: **不满足独立修改/删除条件**

**代码位置**:
- localStorage 使用: `AuthContext.tsx:27-33, 55, 65`
- API 调用: `AuthContext.tsx:40-46`

---

### 3.2 src/contexts/AppContext.tsx - 应用全局上下文

| 评估维度 | 评分 | 说明 |
|---------|------|------|
| 接口清晰度 | 6 分 | 接口完整，但承担过多职责 |
| 依赖管理 | 2 分 | 直接依赖 AuthContext、多个 API 端点 |
| 单一职责 | 1 分 | 承担资源管理、文档管理、设置管理、密码验证等多项职责 |
| 配置分离 | 2 分 | 密码硬编码，API 路径硬编码 |
| 可独立修改 | 1 分 | 修改几乎会影响所有页面模块 |
| 可独立删除 | 0 分 | 删除会导致多个功能完全失效 |
| **总分** | **12 分** | ⚫ **很差** |

**详细分析**:
- ❌ **严重问题**:
  1. **职责过载**: 资源、文档、设置、密码验证混在一起
  2. **硬编码密码**: `PASSWORD = "WM2006"` (AppContext.tsx:52)
  3. **硬编码 API 路径**: `/api/resources`, `/api/documents`, `/api/settings`
  4. **公共耦合**: 所有页面共享同一个全局状态
  5. **印记耦合**: 页面即使只需要一个属性也要获取整个 Context

**代码位置**:
- 密码硬编码: `AppContext.tsx:52, 224-226`
- API 调用: `AppContext.tsx:76, 90, 103, 130, 147, 164, 176, 193, 212`
- 职责过载: `AppContext.tsx:35-50` (interface 定义)

**❌ 独立性评估**: **完全不满足独立修改/删除条件**

---

## 4. 库模块 (Lib)

### 4.1 src/lib/utils.ts - 通用工具函数

| 评估维度 | 评分 | 说明 |
|---------|------|------|
| 接口清晰度 | 10 分 | 函数签名清晰，TypeScript 类型完整 |
| 依赖管理 | 10 分 | 仅依赖外部库 (clsx, tailwind-merge)，无内部依赖 |
| 单一职责 | 10 分 | 仅提供 `cn()` 样式合并函数 |
| 配置分离 | 10 分 | 无配置，纯函数 |
| 可独立修改 | 10 分 | 修改只影响使用该函数的组件 |
| 可独立删除 | 9 分 | 删除后只需替换样式合并逻辑 |
| **总分** | **59 分** | 🟢 **优秀** |

**详细分析**:
- ✅ **优点**:
  - 纯函数，无副作用
  - 类型安全
  - 职责单一
  - 无内部依赖
- ✅ **独立性评估**: **完全满足独立修改/删除条件**

**代码位置**: `src/lib/utils.ts:1-6`

---

### 4.2 src/lib/prisma.ts - Prisma 客户端

| 评估维度 | 评分 | 说明 |
|---------|------|------|
| 接口清晰度 | 8 分 | 简单的单例导出，接口清晰 |
| 依赖管理 | 6 分 | 直接依赖 Prisma Client，无抽象层 |
| 单一职责 | 9 分 | 仅负责 Prisma Client 单例初始化 |
| 配置分离 | 7 分 | 数据库连接通过环境变量，但单例模式硬编码 |
| 可独立修改 | 4 分 | 修改会影响所有 API 路由 |
| 可独立删除 | 0 分 | 删除会导致所有数据库访问失效 |
| **总分** | **34 分** | 🟠 **中等** |

**详细分析**:
- ✅ **优点**: 提供 Prisma Client 单例，避免重复初始化
- ⚠️ **问题**: 所有 API 路由直接依赖此模块，无抽象层
- ❌ **独立性评估**: **不满足独立修改/删除条件**

**代码位置**: `src/lib/prisma.ts:1-5`

---

### 4.3 src/lib/indexedDB.ts - IndexedDB 封装

| 评估维度 | 评分 | 说明 |
|---------|------|------|
| 接口清晰度 | 8 分 | 函数命名清晰，类型定义完整 |
| 依赖管理 | 9 分 | 仅依赖浏览器 IndexedDB API，无内部依赖 |
| 单一职责 | 9 分 | 仅负责 IndexedDB 资源存储操作 |
| 配置分离 | 7 分 | 数据库名和版本硬编码 |
| 可独立修改 | 9 分 | 修改只影响使用该模块的代码 |
| 可独立删除 | 8 分 | 目前似乎未被使用，删除不影响系统 |
| **总分** | **50 分** | 🟢 **优秀** |

**详细分析**:
- ✅ **优点**:
  - 封装清晰，接口友好
  - 无内部依赖
  - 职责单一
- ⚠️ **问题**: 数据库名和版本硬编码 (`DB_NAME = "WestMarchDB"`, `DB_VERSION = 1`)
- ✅ **独立性评估**: **满足独立修改/删除条件** (当前未被使用)

**代码位置**: `src/lib/indexedDB.ts:1-79`

---

## 5. UI 组件模块

### 5.1 src/components/ui/button.tsx - 按钮组件

| 评估维度 | 评分 | 说明 |
|---------|------|------|
| 接口清晰度 | 9 分 | Props 设计合理，类型完整 |
| 依赖管理 | 9 分 | 仅依赖 `utils.ts` 的 `cn()` 函数 |
| 单一职责 | 10 分 | 仅提供可复用的按钮组件 |
| 配置分离 | 9 分 | 样式通过 Tailwind 类配置，无硬编码 |
| 可独立修改 | 10 分 | 修改只影响使用该组件的页面 |
| 可独立删除 | 9 分 | 删除后可替换为其他按钮组件 |
| **总分** | **56 分** | 🟢 **优秀** |

**详细分析**:
- ✅ **优点**:
  - 可复用性强
  - 依赖最小化
  - 职责单一
- ✅ **独立性评估**: **完全满足独立修改/删除条件**

---

### 5.2 src/components/ui/card.tsx - 卡片组件

| 评估维度 | 评分 | 说明 |
|---------|------|------|
| 接口清晰度 | 9 分 | 提供 Card、CardHeader、CardTitle 等子组件，接口清晰 |
| 依赖管理 | 9 分 | 仅依赖 `utils.ts` 的 `cn()` 函数 |
| 单一职责 | 10 分 | 仅提供可复用的卡片组件族 |
| 配置分离 | 9 分 | 样式通过 Tailwind 类配置 |
| 可独立修改 | 10 分 | 修改只影响使用该组件的页面 |
| 可独立删除 | 9 分 | 删除后可替换为其他卡片组件 |
| **总分** | **56 分** | 🟢 **优秀** |

**详细分析**:
- ✅ **优点**: 组合式设计，灵活性高
- ✅ **独立性评估**: **完全满足独立修改/删除条件**

---

### 5.3 src/components/theme-provider.tsx - 主题提供者

| 评估维度 | 评分 | 说明 |
|---------|------|------|
| 接口清晰度 | 8 分 | 封装 next-themes，接口清晰 |
| 依赖管理 | 8 分 | 仅依赖 next-themes 库 |
| 单一职责 | 9 分 | 仅负责主题管理 |
| 配置分离 | 6 分 | 默认主题硬编码为 "dark" |
| 可独立修改 | 8 分 | 修改只影响主题相关功能 |
| 可独立删除 | 7 分 | 删除后需移除 layout.tsx 中的引用 |
| **总分** | **46 分** | 🟡 **良好** |

**详细分析**:
- ✅ **优点**: 封装良好，职责单一
- ⚠️ **问题**: 默认主题配置硬编码
- ✅ **独立性评估**: **基本满足独立修改/删除条件**

---

## 6. API 路由模块

### 6.1 API 路由层整体评估

**所有 API 路由**: `src/app/api/**/route.ts` (共 14 个文件)

| 评估维度 | 评分 | 说明 |
|---------|------|------|
| 接口清晰度 | 7 分 | RESTful 设计，但类型定义分散 |
| 依赖管理 | 2 分 | 所有路由直接依赖 Prisma Client，无抽象层 |
| 单一职责 | 6 分 | 基本按资源划分，但部分包含业务逻辑 |
| 配置分离 | 4 分 | 默认文档硬编码在 documents/route.ts 中 |
| 可独立修改 | 3 分 | 修改数据库模型会影响所有路由 |
| 可独立删除 | 2 分 | 单个资源 API 可删除，但会影响对应页面 |
| **总分** | **24 分** | 🔴 **较差** |

**详细分析**:

#### 共同问题:
1. **无 Repository 抽象层**: 所有路由直接导入 `prisma from '@/lib/prisma'`
2. **公共耦合**: 共享同一个 Prisma Client 单例
3. **业务逻辑耦合**: 部分路由包含业务逻辑

#### 具体问题模块:

**src/app/api/documents/route.ts**:
- 硬编码默认文档数据 (4-91 行)
- 数据初始化逻辑与 API 路由耦合

**受影响文件列表**:
1. `src/app/api/auth/login/route.ts`
2. `src/app/api/characters/route.ts`
3. `src/app/api/characters/[id]/route.ts`
4. `src/app/api/documents/route.ts`
5. `src/app/api/documents/[id]/route.ts`
6. `src/app/api/posts/route.ts`
7. `src/app/api/posts/[id]/route.ts`
8. `src/app/api/resources/route.ts`
9. `src/app/api/resources/[id]/route.ts`
10. `src/app/api/parties/route.ts`
11. `src/app/api/parties/[id]/route.ts`
12. `src/app/api/map/route.ts`
13. `src/app/api/map/nodes/route.ts`
14. `src/app/api/map/edges/route.ts`
15. `src/app/api/settings/[userId]/route.ts`

**❌ 独立性评估**: **不满足独立修改/删除条件** (整体)

---

## 7. 页面模块 (Pages)

### 7.1 src/app/page.tsx - 首页

| 评估维度 | 评分 | 说明 |
|---------|------|------|
| 接口清晰度 | 8 分 | 作为页面组件，无外部接口 |
| 依赖管理 | 5 分 | 依赖 AuthContext、AppContext、UI 组件 |
| 单一职责 | 8 分 | 负责首页展示和登录入口 |
| 配置分离 | 7 分 | 背景图片路径硬编码 |
| 可独立修改 | 7 分 | 修改主要影响首页外观 |
| 可独立删除 | 3 分 | 删除会导致应用入口缺失，但其他页面仍可访问 |
| **总分** | **38 分** | 🟠 **中等** |

**详细分析**:
- ✅ **优点**: 页面逻辑相对独立
- ⚠️ **问题**: 依赖两个 Context
- ❌ **独立性评估**: **不满足独立修改/删除条件**

---

### 7.2 src/app/board/page.tsx - 布告栏页面

| 评估维度 | 评分 | 说明 |
|---------|------|------|
| 接口清晰度 | 7 分 | 页面组件，无外部接口 |
| 依赖管理 | 4 分 | 依赖 AuthContext、AppContext、直接调用 posts API、直接使用 localStorage |
| 单一职责 | 7 分 | 负责帖子展示和管理 |
| 配置分离 | 4 分 | localStorage key 硬编码，API 路径硬编码 |
| 可独立修改 | 5 分 | 修改会影响自身，但不影响其他页面 |
| 可独立删除 | 6 分 | 删除后不影响其他功能 |
| **总分** | **33 分** | 🟠 **中等** |

**详细分析**:
- ⚠️ **问题**:
  - 直接调用 `/api/posts` API (未通过 AppContext)
  - 直接使用 localStorage 存储搜索历史
  - 与其他页面的数据管理方式不一致

**代码位置**:
- API 调用: `board/page.tsx:58-71, 73-97`
- localStorage 使用: `board/page.tsx:46-52, 148-164`

**❌ 独立性评估**: **不满足独立修改/删除条件**

---

### 7.3 src/app/map/page.tsx - 地图页面

| 评估维度 | 评分 | 说明 |
|---------|------|------|
| 接口清晰度 | 7 分 | 页面组件，无外部接口 |
| 依赖管理 | 4 分 | 依赖 AppContext、直接调用多个 map API |
| 单一职责 | 7 分 | 负责世界地图展示和编辑 |
| 配置分离 | 5 分 | API 路径硬编码 |
| 可独立修改 | 5 分 | 修改会影响自身，但不影响其他页面 |
| 可独立删除 | 7 分 | 删除后不影响其他功能 |
| **总分** | **35 分** | 🟠 **中等** |

**详细分析**:
- ⚠️ **问题**:
  - 直接调用 `/api/map`, `/api/map/nodes`, `/api/map/edges` API
  - 自行管理 nodes 和 edges 状态 (未使用 AppContext)

**代码位置**: `map/page.tsx:86-113, 115-142, 154-180, 192-221, 223-238`

**❌ 独立性评估**: **不满足独立修改/删除条件**

---

### 7.4 src/app/characters/page.tsx - 角色页面

| 评估维度 | 评分 | 说明 |
|---------|------|------|
| 接口清晰度 | 7 分 | 页面组件，无外部接口 |
| 依赖管理 | 4 分 | 依赖 AuthContext、AppContext、直接调用 characters API |
| 单一职责 | 7 分 | 负责角色管理 |
| 配置分离 | 5 分 | API 路径硬编码 |
| 可独立修改 | 5 分 | 修改会影响自身，但不影响其他页面 |
| 可独立删除 | 7 分 | 删除后不影响其他功能 |
| **总分** | **35 分** | 🟠 **中等** |

**详细分析**:
- ⚠️ **问题**:
  - 直接调用 `/api/characters` API
  - 自行管理 characters 状态 (未使用 AppContext)

**代码位置**: `characters/page.tsx:76-89, 107-181`

**❌ 独立性评估**: **不满足独立修改/删除条件**

---

## 8. 模块独立性总结

### 8.1 模块评级分布

| 评级 | 模块数量 | 占比 | 模块列表 |
|------|---------|------|---------|
| 🟢 优秀 | 4 | 23.5% | utils.ts, indexedDB.ts, button.tsx, card.tsx |
| 🟡 良好 | 1 | 5.9% | theme-provider.tsx |
| 🟠 中等 | 5 | 29.4% | schema.prisma, layout.tsx, prisma.ts, page.tsx, board/page.tsx, map/page.tsx, characters/page.tsx |
| 🔴 较差 | 3 | 17.6% | AuthContext.tsx, API 路由层整体 |
| ⚫ 很差 | 1 | 5.9% | AppContext.tsx |

### 8.2 关键问题总结

#### 🔴 高优先级问题

1. **AppContext.tsx 职责过载**
   - 承担资源管理、文档管理、设置管理、密码验证等多项职责
   - 硬编码密码 "WM2006"
   - 所有页面共享全局状态

2. **API 路由层缺乏抽象**
   - 所有 14 个 API 路由直接依赖 Prisma Client
   - 无 Repository 模式抽象
   - 难以进行单元测试和数据库替换

3. **公共耦合严重**
   - 多个模块共享全局 Context 状态
   - 多个模块共享 localStorage

#### 🟡 中优先级问题

4. **状态管理不一致**
   - 部分页面使用 AppContext
   - 部分页面自行管理状态 (board, map, characters)

5. **硬编码问题**
   - 密码硬编码
   - 默认文档硬编码
   - API 路径硬编码
   - localStorage keys 硬编码

6. **存储逻辑分散**
   - localStorage 使用分散在 AuthContext、BoardPage 等多个模块

---

## 9. 满足独立修改/删除条件的模块

### 9.1 🟢 完全满足独立修改/删除条件

| 模块 | 路径 | 评级 | 说明 |
|------|------|------|------|
| **utils.ts** | `src/lib/utils.ts` | 🟢 优秀 (59/60) | 纯函数，无副作用，可随时替换 |
| **indexedDB.ts** | `src/lib/indexedDB.ts` | 🟢 优秀 (50/60) | 当前未被使用，可安全删除 |
| **button.tsx** | `src/components/ui/button.tsx` | 🟢 优秀 (56/60) | 可复用 UI 组件，可独立替换 |
| **card.tsx** | `src/components/ui/card.tsx` | 🟢 优秀 (56/60) | 可复用 UI 组件，可独立替换 |

### 9.2 🟡 基本满足独立修改/删除条件

| 模块 | 路径 | 评级 | 说明 |
|------|------|------|------|
| **theme-provider.tsx** | `src/components/theme-provider.tsx` | 🟡 良好 (46/60) | 需从 layout.tsx 中移除引用 |

### 9.3 ❌ 不满足独立修改/删除条件

| 模块 | 路径 | 评级 | 原因 |
|------|------|------|------|
| **AppContext.tsx** | `src/contexts/AppContext.tsx` | ⚫ 很差 (12/60) | 与所有页面深度耦合，职责过载 |
| **AuthContext.tsx** | `src/contexts/AuthContext.tsx` | 🔴 较差 (27/60) | 所有认证相关页面都依赖它 |
| **API 路由层** | `src/app/api/**` | 🔴 较差 (24/60) | 直接依赖 Prisma，无抽象层 |
| **prisma.ts** | `src/lib/prisma.ts` | 🟠 中等 (34/60) | 所有 API 路由都依赖它 |
| **schema.prisma** | `prisma/schema.prisma` | 🟠 中等 (39/60) | 所有数据访问都依赖它 |
| **layout.tsx** | `src/app/layout.tsx` | 🟠 中等 (37/60) | Next.js 根布局，应用入口 |
| **page.tsx** | `src/app/page.tsx` | 🟠 中等 (38/60) | 应用首页，入口页面 |
| **board/page.tsx** | `src/app/board/page.tsx` | 🟠 中等 (33/60) | 依赖 Context 和 API |
| **map/page.tsx** | `src/app/map/page.tsx` | 🟠 中等 (35/60) | 依赖 Context 和 API |
| **characters/page.tsx** | `src/app/characters/page.tsx` | 🟠 中等 (35/60) | 依赖 Context 和 API |

---

## 10. 改进建议

### 10.1 立即重构 (高优先级)

1. **拆分 AppContext**
   - 拆分为 ResourcesContext、DocumentsContext、SettingsContext
   - 将密码验证移至独立模块

2. **引入 Repository 层**
   - 创建 `src/repositories/` 目录
   - 为每个数据模型创建 Repository 类
   - 所有 API 路由通过 Repository 访问数据

3. **创建 API Client 层**
   - 创建 `src/services/api.ts` 封装 fetch 调用
   - 所有 Context 和页面通过 API Client 调用接口

### 10.2 尽快重构 (中优先级)

4. **统一状态管理策略**
   - 明确哪些状态使用 Context，哪些使用页面级 useState
   - 保持一致性

5. **创建存储服务层**
   - 统一管理 localStorage 访问
   - 集中定义 storage keys

6. **提取配置**
   - 将硬编码的密码、默认文档等移至配置文件
   - 使用环境变量管理敏感配置

---

## 附录

### A. 评分详情表

| 模块 | 接口清晰度 | 依赖管理 | 单一职责 | 配置分离 | 可独立修改 | 可独立删除 | 总分 | 评级 |
|------|-----------|---------|---------|---------|-----------|-----------|------|------|
| utils.ts | 10 | 10 | 10 | 10 | 10 | 9 | 59 | 🟢 |
| indexedDB.ts | 8 | 9 | 9 | 7 | 9 | 8 | 50 | 🟢 |
| button.tsx | 9 | 9 | 10 | 9 | 10 | 9 | 56 | 🟢 |
| card.tsx | 9 | 9 | 10 | 9 | 10 | 9 | 56 | 🟢 |
| theme-provider.tsx | 8 | 8 | 9 | 6 | 8 | 7 | 46 | 🟡 |
| schema.prisma | 8 | 10 | 9 | 7 | 5 | 0 | 39 | 🟠 |
| layout.tsx | 9 | 7 | 8 | 8 | 5 | 0 | 37 | 🟠 |
| prisma.ts | 8 | 6 | 9 | 7 | 4 | 0 | 34 | 🟠 |
| page.tsx | 8 | 5 | 8 | 7 | 7 | 3 | 38 | 🟠 |
| board/page.tsx | 7 | 4 | 7 | 4 | 5 | 6 | 33 | 🟠 |
| map/page.tsx | 7 | 4 | 7 | 5 | 5 | 7 | 35 | 🟠 |
| characters/page.tsx | 7 | 4 | 7 | 5 | 5 | 7 | 35 | 🟠 |
| AuthContext.tsx | 8 | 5 | 7 | 4 | 3 | 0 | 27 | 🔴 |
| API 路由层 | 7 | 2 | 6 | 4 | 3 | 2 | 24 | 🔴 |
| AppContext.tsx | 6 | 2 | 1 | 2 | 1 | 0 | 12 | ⚫ |

---

**报告生成完成**  
**评估方法**: 标准化评分体系 + 代码审查  
**下次评估建议**: 重构完成后或 3 个月后
